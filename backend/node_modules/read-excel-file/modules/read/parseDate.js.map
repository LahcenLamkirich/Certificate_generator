{"version":3,"sources":["../../source/read/parseDate.js"],"names":["parseExcelDate","excelSerialDate","options","epoch1904","daysBeforeUnixEpoch","hour","Date","Math","round"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASA,cAAT,CAAwBC,eAAxB,EAAyCC,OAAzC,EAAkD;AAC/D;AACA,MAAIA,OAAO,IAAIA,OAAO,CAACC,SAAvB,EAAkC;AAChCF,IAAAA,eAAe,IAAI,IAAnB;AACD,GAJ8D,CAM/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMG,mBAAmB,GAAG,KAAK,GAAL,GAAW,EAAvC,CAf+D,CAiB/D;AACA;;AACA,MAAMC,IAAI,GAAG,KAAK,EAAL,GAAU,IAAvB;AAEA,SAAO,IAAIC,IAAJ,CAASC,IAAI,CAACC,KAAL,CAAW,CAACP,eAAe,GAAGG,mBAAnB,IAA0C,EAA1C,GAA+CC,IAA1D,CAAT,CAAP;AACD","sourcesContent":["// Parses an Excel Date (\"serial\") into a\r\n// corresponding javascript Date in UTC+0 timezone.\r\n// (with time equal to 00:00)\r\n//\r\n// Doesn't account for leap seconds.\r\n// Therefore is not 100% correct.\r\n// But will do, I guess, since we're\r\n// not doing rocket science here.\r\n//\r\n// https://www.pcworld.com/article/3063622/software/mastering-excel-date-time-serial-numbers-networkdays-datevalue-and-more.html\r\n// \"If you need to calculate dates in your spreadsheets,\r\n//  Excel uses its own unique system, which it calls Serial Numbers\".\r\n//\r\nexport default function parseExcelDate(excelSerialDate, options) {\r\n  // https://support.microsoft.com/en-gb/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel\r\n  if (options && options.epoch1904) {\r\n    excelSerialDate += 1462\r\n  }\r\n\r\n  // \"Excel serial date\" is just\r\n  // the count of days since `01/01/1900`\r\n  // (seems that it may be even fractional).\r\n  //\r\n  // The count of days elapsed\r\n  // since `01/01/1900` (Excel epoch)\r\n  // till `01/01/1970` (Unix epoch).\r\n  // Accounts for leap years\r\n  // (19 of them, yielding 19 extra days).\r\n  const daysBeforeUnixEpoch = 70 * 365 + 19\r\n\r\n  // An hour, approximately, because a minute\r\n  // may be longer than 60 seconds, see \"leap seconds\".\r\n  const hour = 60 * 60 * 1000\r\n\r\n  return new Date(Math.round((excelSerialDate - daysBeforeUnixEpoch) * 24 * hour))\r\n}"],"file":"parseDate.js"}